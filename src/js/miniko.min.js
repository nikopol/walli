// miniko.js 0.7
// ~L~ nikomomo@gmail.com 2012-2014
// https://github.com/nikopol/miniko.js
(function(k){var f=k.document,m=function(a){return null===a?[]:a instanceof Array?a:[a]};k._=function(a,d){var b,c,g;if("object"==typeof a)b=a;else if(a.length)if("#"!=a[0]||/[ ,\.\>\<]/.test(a))if(/^<.+>$/.test(a))(g=f.createElement("div")).innerHTML=a,c=[].slice.call(g.childNodes),b=c.length?1<c.length?c:c[0]:void 0;else for(c=f.querySelectorAll(a),b=[],g=0;g<c.length;++g)b.push(c[g]);else b=f.getElementById(a.substr(1));b&&void 0!=d&&m(b).forEach(function(a){a.innerHTML=d});return b};k.append=function(a,d){var b=_(a);if(void 0==d)return b;m(b).forEach(function(a){var b,l=_("<div>",d);for(b=0;b<l.childNodes.length;++b)a.appendChild(l.childNodes[b])});return b};k.css=function(a,d){var b=_(a),c,g,l,e=/([\+\-\*])([^\+\-\*\s]+)/g;if(void 0==d)return b;if("object"==typeof d)m(b).forEach(function(a){for(c in d)a.style[c]=d[c]});else if(/^[\+\-\*]/.test(d))for(;null!==(c=e.exec(d));)g=c[1],l=c[2],m(b).forEach(function(a){var b=a.className.split(/\s+/).filter(function(a){return a});"-"!=g&&-1==
b.indexOf(l)?b.push(l):"+"!=g&&(b=b.filter(function(a){return a!=l}));a.className=b.join(" ")});else"?"==d[0]?(c=0,d=d.substr(1),m(b).forEach(function(a){c+=a.className.split(" ").filter(function(a){return a==d}).length}),b=c):m(b).forEach(function(a){a.className=d});return b};k.ajax=function(a,d){"string"==typeof a&&(a={url:a,ok:d});var b=a.type||"GET",c=a.url||"",g=a.contenttype||"application/x-www-form-urlencoded",l=a.datatype||"application/json",e=new window.XMLHttpRequest,k,h,f;if(a.data){if("string"==
typeof a.data)h=a.data;else if(/json/.test(g))h=JSON.stringify(a.data);else{h=[];for(f in a.data)h.push(encodeURIComponent(f)+"="+encodeURIComponent(a.data[f]));h=h.join("&")}/GET|DEL/i.test(b)&&(c+=/\?/.test(c)?"&"+h:"?"+h,h="")}a.error||(a.error=function(a,b){console.error(a,b)});a.ok||(a.ok=function(){});e.onreadystatechange=function(){if(4==e.readyState)if(k&&clearTimeout(k),/^2/.test(e.status)){h=e.responseText;if(/json/.test(l))try{h=JSON.parse(e.responseText)}catch(b){return a.error("json parse error: "+
b.message,e)}a.ok(h,e)}else a.error(e.responseText,e)};e.open(b,c,!0);e.setRequestHeader("Content-Type",g);if(a.headers)for(f in a.headers)e.setRequestHeader(f,a.headers[f]);a.timeout&&(k=setTimeout(function(){e.onreadystatechange=function(){};e.abort();a.error&&a.error("timeout",e)},1E3*a.timeout));e.send(h);return e};k.position=function(a){return(a=_(a))?(a=a.getBoundingClientRect(),{left:a.left+window.pageXOffset,top:a.top+window.pageYOffset,width:a.width,height:a.height}):!1};k.ready=function(a){/complete|loaded|interactive/.test(f.readyState)?
a():f.attachEvent?f.attachEvent("ondocumentready",a()):f.addEventListener("DOMContentLoaded",function(){a()},!1)}})(window);